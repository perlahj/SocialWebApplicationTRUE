@model SozialWebApplication.Models.ViewModels.GroupViewModel

<div class="bc">
    @{
        ViewBag.Title = "Banner";
    }

    <br />
    
    <div class="namecard-button">
        <a href="NewsfeedGroups/1">
            <img src="/Myndir/logo.jpg" class="name-logo" alt="name-logo" />
        </a>
        
        <div class="my-name">
            @Html.ActionLink(@Html.ViewContext.HttpContext.User.Identity.Name, "OwnNameCard", "NameCards")
        </div>

        @using (Html.BeginForm("LogOff", "Account", new { ReturnUrl = "/Account/Login" }, FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
        {
            @Html.AntiForgeryToken()

            <div>
                <input type="submit" value="Log Out" class="logout-button" />
            </div>
        }

    </div>

    <br />

    <div class="overflowceeper">
        <div class="feed-body">
            @using SozialWebApplication.Services
            @using SozialWebApplication.Models.Entities
            <div class="groupName">
                <p>@Model.GroupWithId.GroupName</p>
            </div>
        <!--Add group to favorite or remove from favorite groups.-->    
        <div class="add-favgroup">
          
                @if (Model.GroupWithId.GroupName != "News Feed")
                { 
                    using (Html.BeginForm("ClickAddToFavorite", "Home", FormMethod.Post))
                    {

                        if(!SozialWebApplication.Services.GroupService.Instance.IsUserInGroup(Model.GroupWithId.Id, User.Identity.Name))
                        {
                             <input type="hidden" name="hidden-groupId" value="@Model.GroupWithId.Id" />
                            <input type="hidden" name="hidden-favgroup" value="add-group" />
                            <input type="submit" value="Add group to favorite" class="fav-submit" />
                        }
                        else
                        {
                           <input type="hidden" name="hidden-groupId" value="@Model.GroupWithId.Id" />
                            <input type="hidden" name="hidden-favgroup" value="remove-group" />
                            <input type="submit" value="Remove group from favorite" class="fav-submit" /> 
                        }

                    }
                }
            </div>
            <!--Post-->
            @using (Html.BeginForm("NewsfeedGroups", "Home", FormMethod.Post))
            {
                <div class="newsfeed">
                    <div class="post">
                        <div class="post-img">
                            <input type="button" class="input-text" />
                            <input type="button" class="input-img" />
                            <input type="button" class="input-youtube" />
                        </div>

                        <input type="text" name="text-input" id="post-input" class="post-input" placeholder="Express yourself..." />
                        <input type="text" name="photo-input" id="photo-input" class="photo-input" placeholder="Copy photo url here..." />
                        <input type="text" name="video-input" id="video-input" class="video-input" placeholder="Copy YouTube video url here..." />
                    </div>
                </div>
                <input type="submit" value="post" class="post-submit" />
            }
            <!--Display recent posts-->
            <div class="all-posts">
                @foreach (var post in Model.GroupPosts)
                {
                    <div class="whole-each-post">
                        <p class="post-name">@post.UserName</p>
                        <p class="post-date">@post.DateCreated</p>
            
                        <div class="each-post">
                            <div class="post-content">
                                @if(post.PostType == SozialWebApplication.Models.PostType.Text)
                                {
                                   <p>@post.Body</p>
                                }
                                else if (post.PostType == SozialWebApplication.Models.PostType.Photo)
                                {
                                    <img src="@post.Body" alt="Photo from @post.UserName" />
                                }
                                else if (post.PostType == SozialWebApplication.Models.PostType.Video)
                                {
                                    string source ="https://www.youtube.com/embed/" + post.Body;
                                    <p>Source: @source</p> 
                                     <iframe width="560" height="315" src="@source" frameborder="0"></iframe>
                                }
                                
                            </div>
                             
                            <div class="like">
                                <!-- <input type="button" class="like-img" /> -->
                    
                                <!--Form for like button-->
                                @using (Html.BeginForm("ClickLike", "Home", FormMethod.Post))
                                {
                                    <input type="submit" value=" " class="like-img" />
                                    <div class="number-of-likes"><p>#@post.Like</p></div>
                                    <input type="hidden" name="hidden-groupId" value="@Model.GroupWithId.Id" />
                                    <input type="hidden" name="hidden-postId" value="@post.Id" />
                                    <input type="hidden" name="hidden-like" value="add-like" />
                                }
                            </div>

                            <!--Form for new comment-->
                            @using (Html.BeginForm("AddComment", "Home", FormMethod.Post))
                            {
                                <input type="hidden" name="hidden-groupId" value="@Model.GroupWithId.Id" />
                                <input type="hidden" name="hidden-postId" value="@post.Id" />

                            <div class="comment">
                               <!-- <input type="text" name="comment-input" id="comment-input" class="comment-input" placeholder="What do you think?" />-->
                                <textarea rows="2"  cols="80" name="comment-input" class="comment-textarea" placeholder="What do you think?"></textarea>
                                <input type="submit" value="Send" class="submit-comment" />
                            </div>
                            }

                            <!--Display top 25 comments for post-->
                            @{List<Comment> commentsForPost = SozialWebApplication.Services.PostService.Instance.GetAllCommentsForPost(post.Id);}
                
                            @foreach (var comment in commentsForPost)
                            {    
                                <div class="CommentDisplayParent">
                                <div class="CommentDisplay">

                                        <div class="comment-post-name">
                                            <p>@comment.UserName</p>
                                        </div>
                                        <div class="comment-post-date">
                                            <p>@comment.DateCreated</p>
                                        </div>
                                        <p class="post-comment">@comment.Body</p>

                                    
                                </div>
                            </div>
                        </div>
                            </div>
                            }
                    </div>
                            
               
            </div>
                }
        </div> <!--feed-body-->
    </div> <!--overflowceeper-->
    <br />



